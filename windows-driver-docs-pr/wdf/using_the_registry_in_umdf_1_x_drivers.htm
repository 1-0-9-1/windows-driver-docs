<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="Using the Registry in UMDF 1.x Drivers"/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>Using the Registry in UMDF 1.x Drivers</title>

<meta name="MS-HAID" content="umdfobjectdg_50c7f759-b54b-43c3-be04-c14b61206b98.xml"/>
<meta name="MS-HAID" content="umdf.using_the_registry_in_umdf_based_drivers"/>
<meta name="MS-HAID" content="umdf.using_the_registry_in_umdf_drivers"/>
<meta name="MS-HAID" content="wdf.using_the_registry_in_umdf_drivers"/>
<meta name="MS-HAID" content="wdf.using_the_registry_in_umdf_1_x_drivers"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="wdf.using_the_registry_in_umdf_1_x_drivers"></a>Using the Registry in UMDF 1.x Drivers</h1>
</div>
<p class="CCE_Message">[This topic applies to UMDF 1.<i>x</i>.]</p>
<p>UMDF-based drivers can read and write values in the registry by using interfaces of the property store object. </p>
<p>UMDF-based drivers can access four types of registry keys. Drivers can create, read, and write subkeys and values under these keys. The following types of registry keys are available to UMDF-based drivers:</p>
<ul>
<li>
<p>Hardware keys</p>
<p>The PnP manager creates a hardware key, or <i>device key</i>,  for each device, in which it stores the device's unique identification information.</p>
<p>Your driver can retrieve and modify some of the property values under the hardware key. The location of the stored values depends on the method that you use to access them. </p>
<p>Property values that were created using PropertyStore methods are stored in the <b>\Device Parameters</b> subkey, under the hardware key. To access these properties, your driver calls one of the following methods to obtain a property store interface.<p></p>
<dl>
<dt><a id="IWDFDevice__RetrieveDevicePropertyStore"></a><a id="iwdfdevice__retrievedevicepropertystore"></a><a id="IWDFDEVICE__RETRIEVEDEVICEPROPERTYSTORE"></a><a href="wdf.iwdfdevice_retrievedevicepropertystore"><b>IWDFDevice::RetrieveDevicePropertyStore</b></a></dt>
<dd>
<p>Obtains  a pointer to an <a href="wdf.iwdfnamedpropertystore"><b>IWDFNamedPropertyStore</b></a> interface.</p>
</dd>
<dt><a id="IWDFDeviceInitialize__RetrieveDevicePropertyStore"></a><a id="iwdfdeviceinitialize__retrievedevicepropertystore"></a><a id="IWDFDEVICEINITIALIZE__RETRIEVEDEVICEPROPERTYSTORE"></a><a href="wdf.iwdfdeviceinitialize_retrievedevicepropertystore"><b>IWDFDeviceInitialize::RetrieveDevicePropertyStore</b></a></dt>
<dd>
<p>Obtains  a pointer to an <a href="wdf.iwdfnamedpropertystore"><b>IWDFNamedPropertyStore</b></a> interface.</p>
</dd>
<dt><a id="IWDFPropertyStoreFactory__RetrieveDevicePropertyStore"></a><a id="iwdfpropertystorefactory__retrievedevicepropertystore"></a><a id="IWDFPROPERTYSTOREFACTORY__RETRIEVEDEVICEPROPERTYSTORE"></a><a href="wdf.iwdfpropertystorefactory_retrievedevicepropertystore"><b>IWDFPropertyStoreFactory::RetrieveDevicePropertyStore</b></a></dt>
<dd>
<p>Obtains a pointer to an <a href="wdf.iwdfnamedpropertystore2"><b>IWDFNamedPropertyStore2</b></a> interface. You can use the <i>SubkeyPath</i> parameter to specify values under a driver-created subkey, such as <b>\Device Parameters\</b><i>DriverServiceName\subkey</i>.</p>
</dd>
</dl>
</p>
<p>   Drivers have read-only access to values within the <b>\Device Parameters</b> subkey, and cannot access <b>\Device Parameters\WDF</b> or <b>\Device Parameters\WUDF</b>.</p>
<p>Property values that were created using the Unified Device Property model are stored in the <b>\Properties</b> subkey, under the hardware key.</p>
<p>To access these properties, your driver calls <a href="wdf.iwdfunifiedpropertystorefactory_retrieveunifieddevicepropertystore"><b>IWDFUnifiedPropertyStoreFactory::RetrieveUnifiedDevicePropertyStore</b></a> to obtain a property store interface. Then the driver can use the <a href="wdf.iwdfunifiedpropertystore"><b>IWDFUnifiedPropertyStore</b></a> interface
to modify and retrieve current settings of device properties.</p>
</li>
<li>
<p>Software keys</p>
<p>A driver's software key is also called its <i>driver key</i> because the registry contains a software key for each driver. The registry contains a list of all of the device classes, and each driver's software key resides under its device class entry. The system stores information about each driver under its software key.</p>
<p>Your driver can call <a href="wdf.iwdfpropertystorefactory_retrievedevicepropertystore"><b>IWDFPropertyStoreFactory::RetrieveDevicePropertyStore</b></a> to obtain read or write access to values under its software key. The driver can read and write driver-specific information that is not associated with specific devices.</p>
</li>
<li>
<p>Device interface keys</p>
<p>The registry contains keys for all of the <a href="devinst.device_interface_classes">device interface classes</a> that drivers have created. Under each of these keys is an entry for each instance of the device interface class that a driver has registered. </p>
<p>If your driver has registered an instance of a device interface class, it can read and write values under the registry's entry for that instance by calling <a href="wdf.iwdfpropertystorefactory_retrievedevicepropertystore"><b>IWDFPropertyStoreFactory::RetrieveDevicePropertyStore</b></a>. The driver can read and write instance-specific information about the device interface.</p>
</li>
<li>
<p>The <b>DEVICEMAP</b> key</p>
<p>The registry contains a <b>HKEY_LOCAL_MACHINE\HARDWARE\DEVICEMAP</b> key that some drivers for older technologies, such as serial and parallel ports, use. If your driver supports a technology that uses the <b>DEVICEMAP</b> key, the driver can access subkeys and values under the key by calling <a href="wdf.iwdfpropertystorefactory_retrievedevicepropertystore"><b>IWDFPropertyStoreFactory::RetrieveDevicePropertyStore</b></a>.</p>
</li>
</ul>
<p>After a driver has called one of the <b>RetrieveDevicePropertyStore</b> methods to open a registry subkey, the driver can use  methods exposed by  <a href="wdf.iwdfnamedpropertystore"><b>IWDFNamedPropertyStore</b></a>, <a href="wdf.iwdfnamedpropertystore2"><b>IWDFNamedPropertyStore2</b></a>, or  <a href="wdf.iwdfunifiedpropertystore"><b>IWDFUnifiedPropertyStore</b></a> to create, read, and write values under a subkey. The <b>IWDFNamedPropertyStore2</b> interface also enables drivers to delete values.</p>
<p>For more information about registry keys for drivers, see <a href="devinst.overview_of_registry_trees_and_keys">Overview of Registry Trees and Keys</a>.</p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [wdf\wdf]:%20Using the Registry in UMDF 1.x Drivers%20 RELEASE:%20(3/15/2016)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
