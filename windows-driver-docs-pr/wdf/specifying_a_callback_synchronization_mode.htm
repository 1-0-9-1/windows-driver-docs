<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="Specifying a Callback Synchronization Mode"/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>Specifying a Callback Synchronization Mode</title>

<meta name="MS-HAID" content="umdfobjectdg_75e427b0-5a1b-4e17-9512-5890007a2f5b.xml"/>
<meta name="MS-HAID" content="umdf.specifying_a_callback_synchronization_mode"/>
<meta name="MS-HAID" content="wdf.specifying_a_callback_synchronization_mode"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="wdf.specifying_a_callback_synchronization_mode"></a>Specifying a Callback Synchronization Mode</h1>
</div>
<p class="CCE_Message">[This topic applies to UMDF 1.<i>x</i>.]</p>
<p>The driver can specify how its callback functions are called by the framework. The driver specifies a synchronization (or locking) mode for a device before it calls the <a href="wdf.iwdfdriver_createdevice"><b>IWDFDriver::CreateDevice</b></a> method to create a <a href="framework_device_object.htm">device object</a> for the device. To specify synchronization mode, the driver should call the <a href="wdf.iwdfdeviceinitialize_setlockingconstraint"><b>IWDFDeviceInitialize::SetLockingConstraint</b></a> method. The driver receives a pointer to the <a href="wdf.iwdfdeviceinitialize">IWDFDeviceInitialize</a> interface when its <a href="wdf.idriverentry_ondeviceadd"><b>IDriverEntry::OnDeviceAdd</b></a> method is called to add the device to the system. </p>
<p>The driver can specify one of the following values from the WDF_CALLBACK_CONSTRAINT enumeration type in the <i>LockType</i> parameter of <b>IWDFDeviceInitialize::SetLockingConstraint</b> to identify the locking mode. The type of constraint (or locking) specified depends on how much parallelism the hardware device can exploit and how much the driver can handle. </p>
<table>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
<tr>
<td>
<p><b>None</b> (0)</p>
</td>
<td>
<p>Indicates that no callback functions into the driver are synchronized.</p>
</td>
</tr>
<tr>
<td>
<p><b>WdfDeviceLevel</b> (1)</p>
</td>
<td>
<p>Indicates that all queue callback functions into the driver are synchronized. </p>
</td>
</tr>
</table>
<p> </p>
<div class="alert"><b>Note</b>    If the driver does not call <b>IWDFDeviceInitialize::SetLockingConstraint</b> to specify a value, the framework sets the default value of this property to <b>WdfDeviceLevel</b>.</div>
<div> </div>
<p>Constraints apply only to queue callback functions and not to Plug and Play (PnP) and power management callback functions. Queue callback functions include the following:</p>
<ul>
<li>
<p>Automatic dispatch callback functions, such as, <a href="wdf.iqueuecallbackread_onread"><b>IQueueCallbackRead::OnRead</b></a> and <a href="wdf.iqueuecallbackwrite_onwrite"><b>IQueueCallbackWrite::OnWrite</b></a>. For more information, see <a href="i_o_queue_event_callback_functions.htm">I/O Queue Event Callback Functions</a>.</p>
</li>
<li>
<p>Queue state change callback functions, such as, <a href="wdf.iqueuecallbackstatechange_onstatechange"><b>IQueueCallbackStateChange::OnStateChange</b></a>.</p>
</li>
<li>
<p>Request cancellation callback functions, such as, <a href="wdf.irequestcallbackcancel_oncancel"><b>IRequestCallbackCancel::OnCancel</b></a>.</p>
</li>
<li>
<p>File cleanup and close callback functions, such as, <a href="wdf.ifilecallbackcleanup_oncleanupfile"><b>IFileCallbackCleanup::OnCleanupFile</b></a> and <a href="wdf.ifilecallbackclose_onclosefile"><b>IFileCallbackClose::OnCloseFile</b></a>. </p>
</li>
</ul>
<p>Request completion callback functions (<a href="wdf.irequestcallbackrequestcompletion_oncompletion"><b>IRequestCallbackRequestCompletion::OnCompletion</b></a>) are not queue callback functions. Therefore, they are not synchronized.</p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [wdf\wdf]:%20Specifying a Callback Synchronization Mode%20 RELEASE:%20(3/15/2016)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
