<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="Creating a Resource Requirements List"/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>Creating a Resource Requirements List</title>

<meta name="MS-HAID" content="Ch4_DFPnPPackage_bf1d140a-467a-461d-9c76-0276879636bf.xml"/>
<meta name="MS-HAID" content="kmdf.creating_a_resource_requirements_list"/>
<meta name="MS-HAID" content="wdf.creating_a_resource_requirements_list"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="wdf.creating_a_resource_requirements_list"></a>Creating a Resource Requirements List</h1>
</div>
<p>When a bus driver detects a child device, the driver is responsible for creating a resource requirements list for the device. Each item in the list is a <a href="kernel.hardware_resources#ddk_logical_configurations_kg#ddk_logical_configurations_kg">logical configuration</a> for the device. </p>
<p>After the driver reports the device during bus enumeration, the framework calls the driver's <a href="wdf.evtdeviceresourcerequirementsquery"><i>EvtDeviceResourceRequirementsQuery</i></a> callback function. This callback function receives a handle to a resource-requirements-list object that represents an empty resource requirements list. </p>
<p>The driver must then do the following to add information to a resource requirements list:</p>
<ul>
<li>
<p>Create an empty logical configuration.</p>
<p>For each logical configuration that the driver will specify, the driver must call <a href="wdf.wdfioresourcelistcreate"><b>WdfIoResourceListCreate</b></a> to create an empty logical configuration.</p>
</li>
<li>
<p>Add resource descriptors to the logical configuration.</p>
<p>To add resource descriptors to a logical configuration, the driver must do the following, for each type of hardware resource that the device requires:</p>
<ol>
<li>Fill in a driver-allocated <a href="kernel.io_resource_descriptor"><b>IO_RESOURCE_DESCRIPTOR</b></a> structure, which specifies a range of valid values for a particular resource.</li>
<li>Call <a href="wdf.wdfioresourcelistappenddescriptor"><b>WdfIoResourceListAppendDescriptor</b></a> or <a href="wdf.wdfioresourcelistinsertdescriptor"><b>WdfIoResourceListInsertDescriptor</b></a> to add the contents of the IO_RESOURCE_DESCRIPTOR structure to a logical configuration. </li>
</ol>
<p>If a device uses more than one instance of a resource type, all drivers in the stack that access the resource must be aware of the order in which resources are added. For example, if a device requires two ranges of I/O port addresses, all drivers that access the resource descriptors must be aware of the order in which the two ranges are added to the logical configuration. </p>
</li>
<li>
<p>Add the logical configuration to the resource requirements list.</p>
<p>To add a logical configuration to the device's resource requirements list, the driver calls <a href="wdf.wdfioresourcerequirementslistappendioreslist"><b>WdfIoResourceRequirementsListAppendIoResList</b></a> or <a href="wdf.wdfioresourcerequirementslistinsertioreslist"><b>WdfIoResourceRequirementsListInsertIoResList</b></a>.</p>
<p>When assigning resources to a device, the PnP manager attempts to match the requirements of the first logical configuration in the list. If the resources required for that configuration are not available, the PnP manager matches the next configuration in the list for which resources are available.</p>
<p>If your driver supports a non-PnP device, your driver typically must also call <a href="wdf.wdfioresourcerequirementslistsetslotnumber"><b>WdfIoResourceRequirementsListSetSlotNumber</b></a> and <a href="wdf.wdfioresourcerequirementslistsetinterfacetype"><b>WdfIoResourceRequirementsListSetInterfaceType</b></a>.</p>
</li>
</ul>
<p>After the driver's <a href="wdf.evtdeviceresourcerequirementsquery"><i>EvtDeviceResourceRequirementsQuery</i></a> callback function returns, the framework passes the resource requirements list to the PnP manager.</p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [wdf\wdf]:%20Creating a Resource Requirements List%20 RELEASE:%20(3/15/2016)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
