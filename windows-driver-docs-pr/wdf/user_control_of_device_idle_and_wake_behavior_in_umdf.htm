<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="User Control of Device Idle and Wake Behavior in UMDF"/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>User Control of Device Idle and Wake Behavior in UMDF</title>

<meta name="MS-HAID" content="umdfobjectdg_943ba694-746b-46ec-a18e-c8f699e5453e.xml"/>
<meta name="MS-HAID" content="umdf.user_control_of_device_idle_and_wake_behavior_in_umdf"/>
<meta name="MS-HAID" content="wdf.user_control_of_device_idle_and_wake_behavior_in_umdf"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="wdf.user_control_of_device_idle_and_wake_behavior_in_umdf"></a>User Control of Device Idle and Wake Behavior in UMDF</h1>
</div>
<p class="CCE_Message">[This topic applies to UMDF 1.<i>x</i>.]</p>
<p>If a device has idle power-down or wake-up capabilities, you can decide whether users should be allowed to enable or disable these capabilities.</p>
<p>Your UMDF-based driver can use the <a href="wdf.iwdfdevice2_assigns0idlesettings"><b>IWDFDevice2::AssignS0IdleSettings</b></a> method to specify whether users with registry access can enable or disable a device's idle power-down capability.</p>
<p>Your driver can use the <a href="wdf.iwdfdevice2_assignsxwakesettings"><b>IWDFDevice2::AssignSxWakeSettings</b></a> method to specify whether users with registry access can enable or disable a device's wake-up capability.</p>
<p>Both of these methods allow the driver to enable the capability, disable the capability, or give users control of the capability: </p>
<ul>
<li>
<p>When a driver calls the <b>AssignS0IdleSettings</b> method, it can give users control of a device's idle capabilities by setting the <i>UserControlOfIdleSettings</i> parameter to <b>IdleAllowUserControl</b> and setting the <i>Enabled</i> parameter to <b>WdfTrue</b> or <b>WdfUseDefault</b>. </p>
</li>
<li>
<p>When a driver calls the <b>AssignSxWakeSettings</b> method, it can give users control of a device's wake capabilities by setting the <i>UserControlOfWakeSettings</i> parameter to <b>WakeAllowUserControl</b> and setting the <i>Enabled</i> parameter to <b>WdfTrue</b> or <b>WdfUseDefault</b>.</p>
</li>
</ul>
<p>If your driver allows users to modify idle and wake settings, the framework provides a user interface, in the form of a property sheet page that Device Manager displays so that users can enable or disable the idle and wake capabilities. (The framework modifies <b>IdleInWorkingState</b> and <b>WakeFromSleepState</b> registry values. Drivers and their installation files must not read or modify these values.)</p>
<p>If a user modifies a device's settings, the framework updates the device's power state to match the new settings, if necessary. For example, if the user disables a device's idle power-down capability while the device is already in a low-power state because it was idle, the framework returns the device to its working state.</p>
<p>If your driver allows users to modify idle and wake settings, the framework enables these settings by default. Some driver writers might want to initially disable the settings before allowing users to modify them. </p>
<p>Therefore, versions 1.9 and later of the framework provide two driver-definable registry values, named <b>WdfDefaultIdleInWorkingState</b> and <b>WdfDefaultWakeFromSleepState</b>, which are stored in the device's <b>Device Parameters\WDF</b> subkey, under the device's <a href="wdf.using_the_registry_in_umdf_drivers">hardware key</a>. The values are REG_DWORD-typed, with "0" indicating the capability is disabled and "1" indicating the capability is enabled.</p>
<p>Your driver's INF file can use an <a href="devinst.inf_addreg_directive"><b>INF AddReg directive</b></a> to create and set the <b>WdfDefaultIdleInWorkingState</b> and <b>WdfDefaultWakeFromSleepState</b> registry values. For example, if your driver enables a device's idle power-down capability, but if the capability must be disabled when the device is installed, the driver's INF file can set <b>WdfDefaultIdleInWorkingState</b> to "0".</p>
<p>The framework examines the <b>WdfDefaultIdleInWorkingState</b> registry value only if the driver sets the <i>UserControlOfIdleSettings</i> parameter to <b>IdleAllowUserControl</b> and the <i>Enabled</i> parameter to <b>WdfTrue</b> or <b>WdfUseDefault</b> when the driver calls the <a href="wdf.iwdfdevice2_assigns0idlesettings"><b>IWDFDevice2::AssignS0IdleSettings</b></a> method. </p>
<p>The framework examines the <b>WdfDefaultWakeFromSleepState</b> registry values only if the driver sets the <i>UserControlOfWakeSettings</i> parameter to <b>IWakeAllowUserControl</b> and the <i>Enabled</i> parameter to <b>WdfTrue</b> or <b>WdfUseDefault</b> when the driver calls the <a href="wdf.iwdfdevice2_assignsxwakesettings"><b>IWDFDevice2::AssignSxWakeSettings</b></a> method.</p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [wdf\wdf]:%20User Control of Device Idle and Wake Behavior in UMDF%20 RELEASE:%20(3/15/2016)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
