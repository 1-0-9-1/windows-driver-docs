<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="Controlling Device Access"/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>Controlling Device Access</title>

<meta name="MS-HAID" content="umdf.controlling_device_access"/>
<meta name="MS-HAID" content="wdf.controlling_device_access"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="wdf.controlling_device_access"></a>Controlling Device Access</h1>
</div>
<p>The UMDF driver host process runs in the context of the local service account. Your driver may need to access other devices or components that do not permit generalized access to the local service account.</p>
<p>Starting in Windows 8, the operating system includes a security identifier (SID) that identifies UMDF drivers.  By including this SID in their device security requirements, devices or components can permit access to UMDF drivers while preventing access from other requests from the local service account.</p>
<p>	The SID for UMDF drivers is SDDL_USER_MODE_DRIVERS,  and the definition is in sddl.h. The full representation of this SID is:</p>
<p>
<pre class="syntax" xml:space="preserve"><code>S-1-5-84-0-0-0-0-0</code></pre>
</p>
<p> The abbreviation for this SID is UD. This abbreviation is available starting in Windows 8.</p>
<p>A driver external to your UMDF driver can specify the SID either in its INF file or in the driver, before it creates the device object.</p>
<h2><a id="Specifying_device_security_in_an_INF_file"></a><a id="specifying_device_security_in_an_inf_file"></a><a id="SPECIFYING_DEVICE_SECURITY_IN_AN_INF_FILE"></a>Specifying device security in an INF file</h2>
<p>In the INF file, you can use either the abbreviated form or the fully specified form of the SID.</p>
<p>

The abbreviated form is available starting in Windows 8:</p>
<p>
<pre class="syntax" xml:space="preserve"><code>HKR,,Security,,"D:P(A;;GA;;;BA)(A;;GA;;;SY)(A;;GA;;;UD)"   

</code></pre>
</p>
<p>On operating systems earlier than Windows 8, you must use the fully specified form:</p>
<p>
<pre class="syntax" xml:space="preserve"><code>HKR,,Security,,"D:P(A;;GA;;;BA)(A;;GA;;;SY)(A;;GA;;;S-1-5-84-0-0-0-0-0)"       
</code></pre>
</p>
<h2><a id="Specifying_device_security_in_a_KMDF_driver"></a><a id="specifying_device_security_in_a_kmdf_driver"></a><a id="SPECIFYING_DEVICE_SECURITY_IN_A_KMDF_DRIVER"></a>Specifying device security in a KMDF driver</h2>
<p>To specify security requirements in the driver, you must use the abbreviated form, which is only available starting in Windows 8.  For example, a KMDF driver could enable access to its device from UMDF drivers by using the following:</p>
<p>
<div class="code"><span codelanguage=""><table>
<tr>
<th></th>
</tr>
<tr>
<td>
<pre>RtlInitUnicodeString(&amp;sddlString, L"D:P(A;;GA;;;BA)(A;;GA;;;SY)(A;;GA;;;UD)");
status = WdfDeviceInitAssignSDDLString(DeviceInit, &amp;sddlString);
</pre>
</td>
</tr>
</table></span></div>
</p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [wdf\wdf]:%20Controlling Device Access%20 RELEASE:%20(3/15/2016)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
