<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="Supporting System Wake-Up"/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>Supporting System Wake-Up</title>

<meta name="MS-HAID" content="Ch4_DFPnPPackage_76451145-9cc1-4789-9fc7-6224cfb8e014.xml"/>
<meta name="MS-HAID" content="kmdf.supporting_system_wake_up"/>
<meta name="MS-HAID" content="wdf.supporting_system_wake_up"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="wdf.supporting_system_wake_up"></a>Supporting System Wake-Up</h1>
</div>
<p>While the system is in a low-power state, some devices can detect an external event, such as an incoming network packet, and then wake the system. For example, if a PCI device has a system wakeup capability, as indicated in the device's Power Management Capabilities (PMC) register, it wakes the system by raising the Power Management Event (PME) signal on the PCI bus.</p>
<p>If your device can wake the system from a system-wide low-power state, the <a href="wdf.evtdriverdeviceadd"><i>EvtDriverDeviceAdd</i></a> callback function in the <a href="power_policy_ownership.htm">power policy owner</a> must perform the following two steps:</p>
<ol>
<li>
<p>Call <a href="wdf.wdfdeviceassignsxwakesettings"><b>WdfDeviceAssignSxWakeSettings</b></a> to specify:<ul>
<li>The low-power state that the device will enter </li>
<li>Whether users can control the device's idle settings</li>
<li>Whether the device's wake capability is enabled or disabled</li>
</ul>
</p>
<p>For more information about these settings, see the <a href="wdf.wdf_device_power_policy_wake_settings"><b>WDF_DEVICE_POWER_POLICY_WAKE_SETTINGS</b></a> structure.</p>
</li>
<li>Call <a href="wdf.wdfdeviceinitsetpowerpolicyeventcallbacks"><b>WdfDeviceInitSetPowerPolicyEventCallbacks</b></a> to register the following event callback functions, if you need them for your device:<ul>
<li><a href="wdf.evtdevicearmwakefromsx"><i>EvtDeviceArmWakeFromSx</i></a> or <a href="wdf.evtdevicearmwakefromsxwithreason"><i>EvtDeviceArmWakeFromSxWithReason</i></a>, which enable the device hardware to respond to an external wake-up event.</li>
<li><a href="wdf.evtdevicedisarmwakefromsx"><i>EvtDeviceDisarmWakeFromSx</i></a>, which disables the device's ability to respond to an external wake-up event. </li>
<li><a href="wdf.evtdevicewakefromsxtriggered"><i>EvtDeviceWakeFromSxTriggered</i></a>, which informs the driver that the bus detected a wake signal.</li>
</ul>
</li>
</ol>
<p>Bus drivers also participate in waking up the system. The driver for the device's bus typically provides <a href="wdf.evtdeviceenablewakeatbus"><i>EvtDeviceEnableWakeAtBus</i></a> and <a href="wdf.evtdevicedisablewakeatbus"><i>EvtDeviceDisableWakeAtBus</i></a> callback functions. These functions do whatever is necessary on the bus adapter to enable and disable a device's ability to wake from a low-power state.</p>
<p>When a bus driver determines that a device has triggered a wake signal, it must call <a href="wdf.wdfdeviceindicatewakestatus"><b>WdfDeviceIndicateWakeStatus</b></a> to inform the framework that the device's power should be restored. The framework then passes this information to the rest of the drivers in the driver stack.</p>
<p>For information about registry entries that control a device's wake capabilities, see <a href="user_control_of_device_idle_and_wake_behavior.htm">User Control of Device Idle and Wake Behavior</a>. </p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [wdf\wdf]:%20Supporting System Wake-Up%20 RELEASE:%20(3/15/2016)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
