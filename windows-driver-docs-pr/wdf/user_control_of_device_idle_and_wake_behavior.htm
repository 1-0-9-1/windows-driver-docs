<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="User Control of Device Idle and Wake Behavior"/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>User Control of Device Idle and Wake Behavior</title>

<meta name="MS-HAID" content="Ch4_DFPnPPackage_d1a5a204-547b-4453-8c98-854114e362c9.xml"/>
<meta name="MS-HAID" content="kmdf.user_control_of_device_idle_and_wake_behavior"/>
<meta name="MS-HAID" content="wdf.user_control_of_device_idle_and_wake_behavior"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="wdf.user_control_of_device_idle_and_wake_behavior"></a>User Control of Device Idle and Wake Behavior</h1>
</div>
<p>If a device has idle power-down or wake-up capabilities, you can decide whether users should be allowed to enable or disable these capabilities.</p>
<p>Your driver can use members of the <a href="wdf.wdf_device_power_policy_idle_settings"><b>WDF_DEVICE_POWER_POLICY_IDLE_SETTINGS</b></a> structure to specify whether users with registry access can enable or disable a device's idle power-down capability.</p>
<p>Your driver can use members of the <a href="wdf.wdf_device_power_policy_wake_settings"><b>WDF_DEVICE_POWER_POLICY_WAKE_SETTINGS</b></a> structure to specify whether users with registry access can enable or disable a device's wake-up capability.</p>
<p>Both of these structures allow the driver to enable the capability, disable the capability, or give users control of the capability. To give users control, in the appropriate settings structure the driver sets the <b>UserControlOfIdleSettings</b> or <b>UserControlOfWakeSettings</b> member to <b>IdleAllowUserControl</b> or <b>WakeAllowUserControl</b>, respectively, and the <b>Enabled</b> member to <b>WdfTrue</b> or <b>WdfUseDefault</b>,.</p>
<p>If your driver allows users to modify idle and wake settings, the framework provides a user interface, in the form of a property sheet page that Device Manager displays so that users can enable or disable the idle and wake capabilities. (The framework modifies <b>IdleInWorkingState</b> and <b>WakeFromSleepState </b>registry values. Drivers and their installation files must <i>not</i> read or modify these values.)</p>
<p>If a user modifies a device's settings, the framework updates the device's power state to match the new settings, if necessary. For example, if the user disables a device's idle power-down capability while the device is already in a low-power state because it was idle, the framework returns the device to its working state.</p>
<p>If your driver allows users to modify idle and wake settings, the framework enables these settings by default. Some driver writers might want to initially disable the settings before allowing users to modify them. </p>
<p>Therefore, for version 1.9 and later versions of KMDF, the framework provides two driver-definable registry values, named <b>WdfDefaultIdleInWorkingState </b>and <b>WdfDefaultWakeFromSleepState</b>, which are stored in the device's <b>Device Parameters\WDF</b> subkey, under the device's hardware key. The values are REG_DWORD-typed, with "0" indicating the capability is disabled and "1" indicating the capability is enabled.</p>
<p>Your driver's INF file can use an <a href="devinst.inf_addreg_directive"><b>INF AddReg directive</b></a> to create and set the <b>WdfDefaultIdleInWorkingState </b>and <b>WdfDefaultWakeFromSleepState </b>registry values. For example, if your driver enables a device's idle power-down capability, but if the capability must be disabled when the device is installed, the driver's INF file can set <b>WdfDefaultIdleInWorkingState </b>to "0".</p>
<p>The framework examines the <b>WdfDefaultIdleInWorkingState </b>and <b>WdfDefaultWakeFromSleepState </b>registry values only if the driver has set the <b>UserControlOfIdleSettings</b> or <b>UserControlOfWakeSettings</b> member to to <b>IdleAllowUserControl</b> or <b>WakeAllowUserControl</b>, respectively, and the <b>Enabled</b> member to <b>WdfTrue</b> or <b>WdfUseDefault</b>, in the appropriate settings structure.</p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [wdf\wdf]:%20User Control of Device Idle and Wake Behavior%20 RELEASE:%20(3/15/2016)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
