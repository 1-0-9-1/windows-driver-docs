<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="A Device Returns to Its Working State"/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>A Device Returns to Its Working State</title>

<meta name="MS-HAID" content="Ch4_DFPnPPackage_47db5f03-9eeb-4e0f-a54e-22c893cd5827.xml"/>
<meta name="MS-HAID" content="kmdf.a_device_returns_to_its_working_state"/>
<meta name="MS-HAID" content="wdf.a_device_returns_to_its_working_state"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="wdf.a_device_returns_to_its_working_state"></a>A Device Returns to Its Working State</h1>
</div>
<p>A device that is in a low-power state returns to its working state if one of the following occurs:</p>
<ul>
<li>
<p>The device detects an external event and triggers a wake signal on its bus. The bus driver that detects the wake signal calls <a href="wdf.wdfdeviceindicatewakestatus"><b>WdfDeviceIndicateWakeStatus</b></a>. As a result, the framework calls the bus driver's <a href="wdf.evtdevicedisablewakeatbus"><i>EvtDeviceDisableWakeAtBus</i></a> callback function.</p>
</li>
<li>
<p>The device has been idle and a driver calls <a href="wdf.wdfdevicestopidle"><b>WdfDeviceStopIdle</b></a>.</p>
</li>
<li>
<p>The system's power state has changed from a low-power state to its working (S0) state.</p>
</li>
</ul>
<p>In each of these situations, the framework calls the bus driver's <a href="wdf.evtdeviced0entry"><i>EvtDeviceD0Entry</i></a> callback function, which then restores the device (a child device of the bus) to its working (D0) state.</p>
<p>For each function and filter driver that supports the device, the framework does the following, in sequence, one driver at a time, starting with the driver that is lowest in the driver stack:</p>
<ol>
<li>
<p>The framework calls the driver's <a href="wdf.evtdeviced0entry"><i>EvtDeviceD0Entry</i></a> callback function (if it exists).</p>
</li>
<li>
<p>The framework calls the driver's <a href="wdf.evtinterruptenable"><i>EvtInterruptEnable</i></a> callback function (if it exists) for each interrupt, and then it calls the driver's <a href="wdf.evtdeviced0entrypostinterruptsenabled"><i>EvtDeviceD0EntryPostInterruptsEnabled</i></a> callback function (if it exists), so that the driver can enable device interrupts.</p>
</li>
<li>
<p>If the hardware and driver support DMA, the framework calls the driver's <a href="wdf.evtdmaenablerfill"><i>EvtDmaEnablerFill</i></a>, <a href="wdf.evtdmaenablerenable"><i>EvtDmaEnablerEnable</i></a>, and <a href="wdf.evtdmaenablerselfmanagediostart"><i>EvtDmaEnablerSelfManagedIoStart</i></a> callback functions (if they exist) for each DMA channel that was created.</p>
</li>
<li>
<p>If the driver is the device's power policy owner, the framework calls its <a href="wdf.evtdevicedisarmwakefroms0"><i>EvtDeviceDisarmWakeFromS0</i></a> or <a href="wdf.evtdevicedisarmwakefromsx"><i>EvtDeviceDisarmWakeFromSx</i></a> callback function.</p>
</li>
<li>
<p>The framework calls the driver's <a href="wdf.evtchildlistscanforchildren"><i>EvtChildListScanForChildren</i></a> callback function (if it exists).</p>
</li>
<li>
<p>The framework restarts all of the driver's power-managed I/O queues and calls their <a href="wdf.evtioresume"><i>EvtIoResume</i></a> callback functions (if necessary).</p>
</li>
<li>
<p>If the driver is using self-managed I/O, the framework calls the driver's <a href="wdf.evtdeviceselfmanagediorestart"><i>EvtDeviceSelfManagedIoRestart</i></a> callback function.</p>
</li>
</ol>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [wdf\wdf]:%20A Device Returns to Its Working State%20 RELEASE:%20(3/15/2016)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
