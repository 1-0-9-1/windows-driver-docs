<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="Handling an IRP that the Framework Does Not Support"/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>Handling an IRP that the Framework Does Not Support</title>

<meta name="MS-HAID" content="Ch8_DFTechniques_17a0320f-2dc1-4e4d-9a02-a0a078498c95.xml"/>
<meta name="MS-HAID" content="kmdf.handling_an_irp_that_the_framework_does_not_support"/>
<meta name="MS-HAID" content="wdf.handling_an_irp_that_the_framework_does_not_support"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="wdf.handling_an_irp_that_the_framework_does_not_support"></a>Handling an IRP that the Framework Does Not Support</h1>
</div>
<p class="CCE_Message">[Applies to KMDF only]</p>
<p>The framework does not support I/O requests that have the following major IRP codes:</p>
<dl>
<dd>IRP_MJ_CREATE_MAILSLOT</dd>
<dd>IRP_MJ_CREATE_NAMED_PIPE</dd>
<dd>IRP_MJ_DEVICE_CHANGE</dd>
<dd><a href="ifsk.irp_mj_directory_control"><b>IRP_MJ_DIRECTORY_CONTROL</b></a></dd>
<dd><a href="kernel.irp_mj_file_system_control"><b>IRP_MJ_FILE_SYSTEM_CONTROL</b></a></dd>
<dd><a href="kernel.irp_mj_flush_buffers"><b>IRP_MJ_FLUSH_BUFFERS</b></a></dd>
<dd><a href="ifsk.irp_mj_lock_control"><b>IRP_MJ_LOCK_CONTROL</b></a></dd>
<dd><a href="ifsk.irp_mj_query_ea"><b>IRP_MJ_QUERY_EA</b></a></dd>
<dd><a href="ifsk.irp_mj_query_information"><b>IRP_MJ_QUERY_INFORMATION</b></a></dd>
<dd><a href="ifsk.irp_mj_query_quota"><b>IRP_MJ_QUERY_QUOTA</b></a></dd>
<dd><a href="ifsk.irp_mj_query_security"><b>IRP_MJ_QUERY_SECURITY</b></a></dd>
<dd><a href="ifsk.irp_mj_query_volume_information"><b>IRP_MJ_QUERY_VOLUME_INFORMATION</b></a></dd>
<dd><a href="ifsk.irp_mj_set_ea"><b>IRP_MJ_SET_EA</b></a></dd>
<dd><a href="kernel.irp_mj_set_information"><b>IRP_MJ_SET_INFORMATION</b></a></dd>
<dd><a href="ifsk.irp_mj_set_quota"><b>IRP_MJ_SET_QUOTA</b></a></dd>
<dd><a href="ifsk.irp_mj_set_security"><b>IRP_MJ_SET_SECURITY</b></a></dd>
<dd><a href="ifsk.irp_mj_set_volume_information"><b>IRP_MJ_SET_VOLUME_INFORMATION</b></a></dd>
</dl>
<p>If the framework receives an IRP that contains one of these I/O function codes, the framework does not process the IRP. If your driver is a filter driver, the framework passes the IRP to the next-lower driver in the driver stack. If your driver is not a filter driver, the framework calls <a href="kernel.iocompleterequest"><b>IoCompleteRequest</b></a> to complete the IRP with a status value of STATUS_INVALID_DEVICE_REQUEST.</p>
<p>If your driver must handle IRPs that contain any of these I/O function codes, the driver must call <a href="wdf.wdfdeviceinitassignwdmirppreprocesscallback"><b>WdfDeviceInitAssignWdmIrpPreprocessCallback</b></a> to register an <a href="wdf.evtdevicewdmirppreprocess"><i>EvtDeviceWdmIrpPreprocess</i></a> event callback function for an I/O function code. </p>
<p>When the driver receives an IRP that contains an I/O function code that the driver has registered an <a href="wdf.evtdevicewdmirppreprocess"><i>EvtDeviceWdmIrpPreprocess</i></a> callback function for, the framework passes the IRP to the callback function. The callback function must then process the IRP by following the <a href="kernel.handling_irps">WDM rules for handling IRPs</a>. The driver must call <a href="kernel.iocompleterequest"><b>IoCompleteRequest</b></a> to complete the IRP, or it must call <a href="kernel.iocalldriver"><b>IoCallDriver</b></a> to pass the IRP to the next-lower driver.</p>
<p>For an example of an <a href="wdf.evtdevicewdmirppreprocess"><i>EvtDeviceWdmIrpPreprocess</i></a> callback function that handles an IRP that the framework does not support, see the <a href="sample_kmdf_drivers.htm">Serial</a> sample driver.</p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [wdf\wdf]:%20Handling an IRP that the Framework Does Not Support%20 RELEASE:%20(3/15/2016)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
