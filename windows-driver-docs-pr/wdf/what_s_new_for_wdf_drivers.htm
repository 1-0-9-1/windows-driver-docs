<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="This topic summarizes the new features and improvements for Windows Driver Frameworks (WDF) drivers in Windows 10.Windows 10 includes Kernel-Mode Driver Framework (KMDF) version 1.15 and User-Mode Driver Framework (UMDF) version 2.15."/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>What's New for  WDF Drivers in Windows 10</title>

<meta name="MS-HAID" content="Ch0_DFArchOverview_13237610-45bf-4d4d-80e5-9a79b96f14dd.xml"/>
<meta name="MS-HAID" content="kmdf.kernel_mode_driver_framework_overview"/>
<meta name="MS-HAID" content="wdf.getting_started_with_kernel_mode_driver_framework"/>
<meta name="MS-HAID" content="wdf.kernel_mode_driver_framework_overview"/>
<meta name="MS-HAID" content="wdf.what_s_new_for_wdf_drivers"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="wdf.what_s_new_for_wdf_drivers"></a>What's New for  WDF Drivers in Windows 10</h1>
</div>
<div class="nav_sidebar" style="background: #ebeff0; border: 1px #e3e3e3 solid; padding: 5px; float: right; margin-left: 10px; width: 290px;"><span class="sidebar_heading" style="font-weight: bold;">In this article</span><div class="sidebar_toc">
<p>
<ul>
<li><a href="#wdf_source_code_is_now_publicly_available">WDF source code is now publicly available</a></li>
<li><a href="#automatic_source_level_debugging_of_framework_code">Automatic Source Level Debugging of Framework Code</a></li>
<li><a href="#universal_driver_compliance">Universal Driver Compliance</a></li>
<li><a href="#debugging_and_diagnosability">Debugging and Diagnosability</a></li>
<li><a href="#new_performance_tracing_tool_for_wdf_drivers">New Performance Tracing tool for WDF drivers</a></li>
<li><a href="#additional_support_for_hid_drivers_in_umdf">Additional support for HID drivers in UMDF</a></li>
<li><a href="#support_for_interrupts_for_gpio-backed_devices">Support for interrupts for GPIO-backed devices</a></li>
<li><a href="#umdf_no_longer_requires_winusb">UMDF no longer requires WinUSB</a></li>
<li><a href="#ddi_updates">DDI Updates</a></li>
<li><a href="#improved_performance">Improved Performance</a></li>
</ul>
</p>
</div>
</div>
<p>
<p>This topic summarizes the new features and improvements for  Windows Driver Frameworks (WDF) drivers in Windows 10.</p>
<p>Windows 10 includes Kernel-Mode Driver Framework (KMDF) version 1.15 and  User-Mode Driver Framework (UMDF) version 2.15.</p>
</p>
<p>  You can use these framework versions to build drivers for:<ul>
<li>Windows 10 for desktop editions (Home, Pro, Enterprise, and Education)</li>
<li>Windows 10 Mobile</li>
<li>Windows 10 IoT Core (IoT Core)</li>
<li>Windows Server 2016 Technical Preview</li>
</ul>
</p>
<p>For version history, see <a href="kmdf_version_history.htm">KMDF Version History</a>
 and <a href="umdf_version_history.htm">UMDF Version History</a>. Except where noted, UMDF references on this page describe version 2 functionality that is not available in UMDF version 1.</p>
<p></p>
<h2><a id="WDF_source_code_is_now_publicly_available"></a><a id="wdf_source_code_is_now_publicly_available"></a><a id="WDF_SOURCE_CODE_IS_NOW_PUBLICLY_AVAILABLE"></a>WDF source code is now publicly available</h2>
<ul>
<li>
<p>The WDF source code is now available as open source  on GitHub. This is the same source code from which the WDF runtime library that ships in Windows 10 is built.   You can debug your driver more effectively when you can follow the interactions between the driver and WDF. Download it from  <a href="http://github.com/Microsoft/Windows-Driver-Frameworks">http://github.com/Microsoft/Windows-Driver-Frameworks</a>.</p>
</li>
<li>
<p>The private symbol files for WDF on Windows 10 are now available through the Microsoft Symbol Server.</p>
</li>
<li>
<p>The Windows Driver Kit (WDK) 10 samples are also now published to GitHub.  Download them from  <a href="http://github.com/Microsoft/Windows-Driver-Samples">http://github.com/Microsoft/Windows-Driver-Samples</a>.</p>
</li>
</ul>
<h2><a id="Automatic_Source_Level_Debugging_of_Framework_Code"></a><a id="automatic_source_level_debugging_of_framework_code"></a><a id="AUTOMATIC_SOURCE_LEVEL_DEBUGGING_OF_FRAMEWORK_CODE"></a>Automatic Source Level Debugging of Framework Code</h2>
<p>When you use WinDbg to debug a WDF driver on Windows 10, WinDbg automatically retrieves the framework source code from Microsoft's public GitHub repository. You can use this feature to step through the WDF source code while debugging, and to learn about framework internals without downloading the source code to a local machine.
 For more information, see <a href="http://go.microsoft.com/fwlink/?LinkId=618534">New support for source-level debugging of WDF code in Windows 10</a>,  <a href="http://go.microsoft.com/fwlink/?LinkId=618535">Debugging with WDF Source</a>, and <a href="video__debugging_your_driver_with_wdf_source_code.htm">Video: Debugging your driver with WDF source code</a>.</p>
<h2><a id="Universal_Driver_Compliance"></a><a id="universal_driver_compliance"></a><a id="UNIVERSAL_DRIVER_COMPLIANCE"></a>Universal Driver Compliance</h2>
<p>All WDF driver samples and Visual Studio driver templates are <a href="https://msdn.microsoft.com/windows-drivers/develop/getting_started_with_universal_drivers">Universal Windows driver</a> compliant. </p>
<p>All KMDF and UMDF 2 functionality is Universal Windows driver compliant.</p>
<p>Note that   UMDF 1 drivers run only on  Windows 10 for desktop editions and earlier versions of desktop Windows.  Want to benefit from the universal capabilities of UMDF 2?    To learn how to port your old UMDF 1 driver, see <a href="porting_a_driver_from_umdf_1_to_umdf_2.htm">Porting a Driver from UMDF 1 to UMDF 2</a>.</p>
<h2><a id="Debugging_and_Diagnosability"></a><a id="debugging_and_diagnosability"></a><a id="DEBUGGING_AND_DIAGNOSABILITY"></a>Debugging and Diagnosability</h2>
<ul>
<li>
<p>All KMDF and UMDF 2 drivers can use the new always on, always available Inflight Trace Recorder (IFR).    When a driver provides a custom trace, the driver IFR log contains the trace messages. Note that the new driver IFR log is separate from the framework IFR log that WDF creates for each driver.</p>
<p>It's easy to turn on the IFR. See <a href="devtest.using_wpp_recorder">Inflight Trace Recorder (IFR) for logging traces</a> and <a href="using_wpp_software_tracing_in_kmdf_and_umdf_2_drivers.htm">Using Inflight Trace Recorder  in KMDF and UMDF Drivers</a>.</p>
</li>
<li>
<p>The IFR maintains a circular buffer of WPP traces in non-pageable memory.  If a driver crashes, the logs are frequently included in the crash dump file. </p>
</li>
<li>
<p>If you turn on the IFR in your driver binary, the IFR is present and running during the lifetime of your driver. You don't need to start an explicit trace collection session.</p>
<ul>
<li>
<p>IFR logs are included in minidump files except when the responsible  driver is undetermined or if the crash was a host timeout.</p>
</li>
<li>
<p>You can access both the driver and framework IFR logs by issuing <a href="debugger._wdfkd_wdflogdump"><b>!wdfkd.wdflogdump</b></a>. (Note that <a href="debugger._rcdrkd_rcdrlogdump"><b>!rcdrkd.rcdrlogdump</b></a> is no longer needed for this.)</p>
</li>
<li>
<p>When debugging a UMDF driver,  you can merge framework logs with driver logs by issuing: <b>!wdfkd.wdflogdump </b><i>&lt;drivername.dll&gt;</i><b> -m</b></p>
</li>
</ul>
</li>
<li>
<p>UMDF logs (WudfTrace.etl) and dumps are now located in %ProgramData%\Microsoft\WDF instead of %systemDrive%\LogFiles\Wudf.</p>
</li>
<li>
<p>New debugger command: <a href="debugger._wdfkd_wdfumtriage"><b>!wdfkd.wdfumtriage</b></a> provides a kernel-centric view of all UMDF devices on the system.</p>
</li>
<li>
<p>You can run <a href="debugger._analyze"><b>!analyze</b></a>  to investigate UMDF verifier failures or UMDF unhandled exceptions. This works for live kernel debugging as well as debugging user crash dump files from <i>%ProgramData%</i>\Microsoft\WDF.</p>
</li>
<li>
<p>In KMDF and UMDF 2, you can monitor power reference usage in the debugger.  For info, see <a href="debugging_power_reference_leaks_in_wdf.htm">Debugging Power Reference Leaks in WDF</a>.</p>
</li>
<li>
<p>You can use <a href="debugger._wdfkd_wdfcrashdump"><b>!wdfkd.wdfcrashdump</b></a> to display error information about UMDF 2 drivers.  For more information, see <b>!wdfkd.wdfcrashdump</b>.</p>
</li>
</ul>
<h2><a id="New_Performance_Tracing_tool_for_WDF_drivers"></a><a id="new_performance_tracing_tool_for_wdf_drivers"></a><a id="NEW_PERFORMANCE_TRACING_TOOL_FOR_WDF_DRIVERS"></a>New Performance Tracing tool for WDF drivers</h2>
<p>You can use the Windows Performance Toolkit (WPT) to view performance data for a given KMDF or UMDF 2 driver. When tracing is enabled, the framework generates ETW events for I/O, PnP, and Power callback paths. You can then view graphs in the Windows Performance Analyzer (WPA) that show I/O throughput rates, CPU utilization, and callback performance.
The WPT is included in the Windows Assessment and Deployment Kit (ADK).</p>
<p>For more information, see <a href=" http://go.microsoft.com/fwlink/?LinkId=618537">New Performance Tools for WDF Drivers in Windows 10</a> and <a href="using_the_windows_performance_toolkit__wpt__with_wdf.htm">Using the Windows Performance Toolkit (WPT) with WDF</a>.</p>
<h2><a id="Additional_support_for_HID_drivers_in_UMDF"></a><a id="additional_support_for_hid_drivers_in_umdf"></a><a id="ADDITIONAL_SUPPORT_FOR_HID_DRIVERS_IN_UMDF"></a>Additional support for HID drivers in UMDF</h2>
<ul>
<li>
<p>UMDF now fully supports HID filters (enumerated by HIDClass) and minidrivers. Simply port your existing KMDF driver or write a new UMDF 2 filter; the functionality is automatically enabled.</p>
</li>
<li>
<p>UMDF HID minidrivers that are enumerated by ACPI can perform selective suspend.   For more  information, see <a href="creating_umdf_hid_minidrivers.htm">Creating WDF HID Minidrivers</a>.</p>
</li>
<li>
<p>UMDF drivers can now be installed in the HID stack for low latency input devices such as touch and mouse.  A driver for an input device should specify the <b>UmdfHostPriority</b> INF directive.  For information, see  <a href="specifying_wdf_directives_in_inf_files.htm">Specifying WDF Directives in INF Files</a>.</p>
</li>
</ul>
<h2><a id="Support_for_interrupts_for_GPIO-backed_devices"></a><a id="support_for_interrupts_for_gpio-backed_devices"></a><a id="SUPPORT_FOR_INTERRUPTS_FOR_GPIO-BACKED_DEVICES"></a>Support for interrupts for GPIO-backed devices</h2>
<ul>
<li>
<p>UMDF 2 supports interrupts for GPIO-backed devices like hardware push-buttons.  KMDF supports these devices natively, without the workaround described in <a href="handling_active-both_interrupts.htm">Handling Active-Both Interrupts</a>.  For more information, see <a href="creating_an_interrupt_object.htm">Creating an Interrupt Object</a>.</p>
</li>
</ul>
<h2><a id="UMDF_no_longer_requires_WinUSB"></a><a id="umdf_no_longer_requires_winusb"></a><a id="UMDF_NO_LONGER_REQUIRES_WINUSB"></a>UMDF no longer requires WinUSB</h2>
<p>New support has been added for USB drivers in UMDF.  A UMDF 2 USB driver no longer uses WinUSB. To use the new functionality, the driver sets the <b>UmdfDispatcher</b> directive to <b>NativeUSB</b>, instead of <b>WinUSB</b>. See <a href="specifying_wdf_directives_in_inf_files.htm">Specifying WDF Directives in INF Files</a>.</p>
<h2><a id="DDI_Updates"></a><a id="ddi_updates"></a><a id="DDI_UPDATES"></a>DDI Updates</h2>
<p>For information about new and updated DDIs, please see <a href="umdf_version_history.htm">UMDF Version History</a> and <a href="kmdf_version_history.htm">KMDF Version History</a>.</p>
<h2><a id="Improved_Performance"></a><a id="improved_performance"></a><a id="IMPROVED_PERFORMANCE"></a>Improved Performance</h2>
<ul>
<li>
<p>UMDF system components consume less disk space.</p>
</li>
<li>
<p>KMDF and UMDF drivers use less non-paged memory.</p>
</li>
<li>
<p>Improved framework version checking reduces header/library mismatches.</p>
</li>
<li>
<p>UMDF provides improved buffer mapping for HID transfers.</p>
</li>
</ul>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [wdf\wdf]:%20What's New for  WDF Drivers in Windows%C2%A010%20 RELEASE:%20(3/15/2016)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
