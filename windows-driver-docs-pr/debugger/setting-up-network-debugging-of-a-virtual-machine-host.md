---
title: Setting Up Network Debugging of a Virtual Machine - KDNET
description: If your target computer is a virtual machine host, you can set up network debugging and still have network access for the virtual machines.
ms.assetid: E4C4D2A1-2FB0-4028-8A52-30B8F4F738D0
ms.author: domars
ms.date: 05/18/2018
ms.topic: article
ms.prod: windows-hardware
ms.technology: windows-devices
---

# Setting Up Network Debugging of a Virtual Machine - KDNET

## Sequence to add Hyper-V role to a Windows PC

If your target computer is a virtual machine host, you can set up network debugging and still have network access for the virtual machines.

Suppose you want to set up network debugging in the following situation.

-   The target computer has a single network interface card.
-   You intend to install the Hyper-V role on the target computer.
-   You intend to create one or more virtual machines on the target computer.

The best approach is to set up network debugging on the target computer before you install the Hyper-V role. Then the virtual machines will have access to the network.

If you decide to set up network debugging after the Hyper-V role has been installed on the target computer, you must change the network settings for your virtual machines to bridge them to the Microsoft Kernel Network Debug Adapter. Otherwise, the virtual machines will not have access to the network.


## Setting Up Network Debugging of a Virtual Machine - KDNET

TBD - Add Content


1.

2.

3.

4.

5. Type this command to confirm that the dbgsettings are set properly.

```
C:\> bcdedit /dbgsettings
busparams               0.25.0
key                     2steg4fzbj2sz.23418vzkd4ko3.1g34ou07z4pev.1sp3yo9yz874p
debugtype               NET
hostip                  169.182.1.1
port                    50010
dhcp                    Yes
The operation completed successfully.
```

## Troubleshooting KDNET Virtual Machine Network Debugging 


*Something didn't work right and I'm not sure what..* 

- Ensure you've let WinDbg through your firewall. - On CorpNet, KD must be setup to use port 50000-50039. Make sure you're using one of those.
- Confirm that you are using a unique Key that was generated by BCDEdit or KDNet.

*My VMs don't have network connectivity*  

- Open Virtual Switch Manager from Hyper-V Manager, select your existing Virtual Switch, and change the external network NIC to the Microsoft Kernel Debug Network Adapter by selecting it from the drop down box and then clicking OK in the Virtual Switch Manager dialog box.  After updating your Virtual Switch NIC, make sure to then shutdown and restart your VMs. 

*Everything was working fine and now it's not working* 
- Sometimes the routers/switch/hubs in your office can get stuck. Unplug the power to router/switch/hub for ~60 seconds and then plug back in and reboot target machine. This fixes a number of issues and may need to to happen from time to time. 


## <span id="related_topics"></span>Related topics

[Setting Up Kernel-Mode Debugging of a Virtual Machine Manually](attaching-to-a-virtual-machine--kernel-mode-.md)

[Setting Up a Network Connection Manually](setting-up-a-network-debugging-connection.md)

 

 






