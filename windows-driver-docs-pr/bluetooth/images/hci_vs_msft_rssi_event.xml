<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../BuildX/Script2/preview.xslt"?>
<refpage xmlns="http://microsoft.com/wdcml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://microsoft.com/wdcml ../../BuildX/Schema/xsd/wdcml.xsd">
 <metadata id="bltooth.hci_vs_msft_rssi_event" type="refpage" msdnID="7053C7C4-49CA-44FA-BBCF-ED1BDAE93FD8">
  <title>HCI_VS_MSFT_RSSI_Event</title>
  <devlang value="cpp"/>
  <tech value="bltooth"/>
  <index/>
  <seo nohighlight="1"/>
</metadata>
 <content>
  <desc>
   <p><abstract>HCI_VS_MSFT_RSSI_Event indicates that an <xref targtype="refpage" rid="bltooth.hci_vs_msft_monitor_rssi">HCI_VS_MSFT_Monitor_Rssi</xref> command has completed.</abstract></p><p>If the <placeholder>Status</placeholder> parameter is zero, the command completed because the RSSI value for the remote device changed to a value outside of the specified range. If the <placeholder>Status</placeholder> parameter is non-zero, the command completed because the RSSI value of the connection can no longer be monitored.</p><table><tr><th>Event</th><th>Event Code</th><th>Microsoft event code</th><th>Event parameters</th></tr><tr><td><p>HCI_VS_MSFT_RSSI_Event</p></td><td><p>0xFF</p></td><td><p>0x01</p></td><td><p><placeholder>Event_prefix</placeholder></p><p><placeholder>Microsoft_event_code</placeholder></p><p><placeholder>Status</placeholder></p><p><placeholder>Connection_handle</placeholder></p><p><placeholder>RSSI</placeholder></p></td></tr></table>
  </desc>
  <section><title>Event parameters</title><sectioncontents><list nobullets="1"><item><p><mark type="bullet_intro"><placeholder>Event_prefix</placeholder></mark> (variable size):</p><table><tr><th>Value</th><th>Parameter description</th></tr><tr><td><p><placeholder>Event prefix</placeholder></p></td><td><p>The event prefix that flags this event as Microsoft-defined. The size and value are as returned by the <xref targtype="refpage" rid="bltooth.hci_vs_msft_read_supported_features">HCI_VS_MSFT_Read_Supported_Features</xref> command.</p></td></tr></table></item><item><p><mark type="bullet_intro"><placeholder>Microsoft_event_code</placeholder></mark> (1 octet):</p><table><tr><th>Value</th><th>Parameter description</th></tr><tr><td><p xml:space="default">0x01</p></td><td><p>The event code for HCI_VS_MSFT_RSSI_Event.</p></td></tr></table></item><item><p><mark type="bullet_intro"><placeholder>Status</placeholder></mark> (1 octet):</p><table><tr><th>Value</th><th>Parameter description</th></tr><tr><td><p>0x00</p></td><td><p>Success. The RSSI value of the connection has met one of the following conditions.</p><list><item><p>The RSSI reached or exceeded <placeholder>RSSI_threshold_high</placeholder>.</p></item><item><p>The RSSI reached or dropped below <placeholder>RSSI_threshold_low</placeholder> over <placeholder>RSSI_threshold_low_time_interval</placeholder> seconds.</p></item><item><p>The <placeholder>RSSI_sampling_period</placeholder> has expired and this event was generated to notify the host of the RSSI value.</p></item></list></td></tr><tr><td><p xml:space="preserve">0x01<entity type="nbsp"/>-<entity type="nbsp"/>0xFF</p></td><td><p>Failure. The RSSI value of the connection can no longer be monitored. The error code is usually one of codes that describes why the underlying ACL connection was lost.</p></td></tr></table></item><item><p><mark type="bullet_intro"><placeholder>Connection_handle</placeholder></mark> (2 octets):</p><table><tr><th>Value</th><th>Parameter description</th></tr><tr><td><p>0x<placeholder>XXXX</placeholder></p></td><td><p>The handle for the connection whose RSSI is to be monitored.</p></td></tr></table></item><item><p><mark type="bullet_intro"><placeholder>RSSI</placeholder></mark> (1 octet):</p><table><tr><th>Value</th><th>Parameter description</th></tr><tr><td><p xml:space="default"><placeholder>N</placeholder> = <mark type="param">RSSI<entity type="nbsp"/>value</mark></p></td><td><p>The measured link RSSI value for the connection.</p><p>For BR/EDR:</p><list><item>Range: -128 &lt;= <placeholder>N</placeholder> &lt;= 127 (signed integer)</item><item>Unit: dBm</item></list><p>For LE:</p><list><item>Range: -127 to 20 (signed integer)</item><item>Unit: dBm</item></list></td></tr></table></item></list></sectioncontents></section><seealso><xref targtype="refpage" rid="bltooth.hci_vs_msft_monitor_rssi">HCI_VS_MSFT_Monitor_Rssi</xref></seealso>
  <info><product rid="version">Supported in <tla rid="win_threshold_desktop" expansion="always"/>,  <tla rid="win_threshold_mobile" expansion="first_use_only"/>, and later versions.</product></info>
 </content>
  </refpage>
